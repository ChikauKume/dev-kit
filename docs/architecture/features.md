# 機能一覧

## 概要

このドキュメントでは、授業動画配信プラットフォームの全機能を体系的に整理し、詳細仕様を定義します。product.mdの要件定義に基づいて、第1フェーズ（MVP）と第2フェーズ（拡張機能）に分類しています。

## 対象ユーザー
管理者（教育機関運営者・講師）、一般ユーザー（受講者）、システム

## 第1フェーズ（MVP）機能

### 1. 認証・ユーザー管理機能

#### 1.1. ユーザー登録機能

**対象**: 一般ユーザー | **要件ID**: REQ-1-1

**登録フォーム**:
- 名前（必須）: テキスト入力、最大255文字
- メールアドレス（必須）: メールアドレス形式検証
- パスワード（必須）: 8文字以上、英数字混在
- プロフィール画像（任意）: JPEG/PNG形式、最大5MB

**バリデーション**:
- メールアドレス重複チェック
- パスワード強度チェック（英数字混在）
- 画像ファイル形式・サイズチェック

**登録後の処理**:
- 自動ログイン処理
- ダッシュボードへリダイレクト

#### 1.2. ログイン・ログアウト機能

**対象**: 管理者、一般ユーザー | **要件ID**: REQ-1-2

**ログイン処理**:
- メールアドレスとパスワードで認証
- セッション有効期限: 24時間
- Remember me機能: MVP段階では未実装

**ログアウト処理**:
- セッション情報の削除
- トップページへリダイレクト

**権限分離**:
- 管理者用ログインページ（別URL）
- 一般ユーザー用ログインページ
- ロール based access control (RBAC)

#### 1.3. プロフィール管理機能

**対象**: 管理者、一般ユーザー | **要件ID**: REQ-1-3

**プロフィール表示**:
- 名前
- メールアドレス
- プロフィール画像
- 視聴履歴一覧（動画タイトル、視聴日時、視聴時間）

**プロフィール編集**:
- 名前変更
- プロフィール画像変更
- パスワード変更（現在のパスワード確認必須）

**視聴履歴**:
- 視聴した動画の一覧表示
- 視聴日時順にソート
- 履歴から動画への直接アクセス

### 2. 動画管理機能

#### 2.1. 動画アップロード機能

**対象**: 管理者 | **要件ID**: REQ-2-1

**アップロード仕様**:
- ファイル形式: MP4のみ
- 最大ファイルサイズ: 2GB
- サムネイル画像: JPEG/PNG形式、最大5MB

**必須入力項目**:
- 動画ファイル
- タイトル（必須、最大255文字）
- 説明文（任意、最大5000文字）
- カテゴリ選択（必須）
- タグ入力（任意、複数可、カンマ区切り）
- サムネイル画像（必須）

**アップロード処理**:
- ファイルバリデーション（形式・サイズ）
- ストレージへの保存（Laravel Storage）
- データベース登録
- 自動的に「公開」状態で登録

#### 2.2. 動画管理機能

**対象**: 管理者 | **要件ID**: REQ-2-2

**動画一覧表示**:
- サムネイル
- タイトル
- アップロード日
- 公開状態（公開/非公開）
- 視聴回数
- 操作ボタン（編集/削除/公開切替）

**動画編集**:
- タイトル変更
- 説明文変更
- カテゴリ変更
- タグ変更
- サムネイル画像変更
- 動画ファイルの再アップロード（オプション）

**動画削除**:
- 削除確認ダイアログ表示
- 動画ファイルとデータベース記録の完全削除
- 関連する視聴履歴も削除

**公開/非公開切替**:
- ワンクリックで状態切替
- Ajax処理で即座に反映
- 非公開にすると一般ユーザーから非表示

#### 2.3. カテゴリ・タグ管理機能

**対象**: 管理者 | **要件ID**: REQ-2-3

**カテゴリ管理**:
- カテゴリ一覧表示
- カテゴリ追加（名前、説明、表示順）
- カテゴリ編集
- カテゴリ削除（紐づく動画がない場合のみ）

**タグ管理**:
- タグ一覧表示
- タグ追加
- タグ編集
- タグ削除（紐づく動画がない場合のみ）

### 3. 動画視聴機能

#### 3.1. 動画一覧・検索機能

**対象**: 一般ユーザー | **要件ID**: REQ-3-1

**動画一覧表示**:
- グリッド表示（サムネイル、タイトル、視聴回数、アップロード日）
- ページネーション対応（1ページ20件）
- ソート機能（新着順、人気順）

**検索機能**:
- タイトルによるキーワード検索
- カテゴリフィルター
- タグフィルター
- 複合検索対応

**フィルタリング**:
- カテゴリによる絞り込み
- タグによる絞り込み
- 検索結果の件数表示

#### 3.2. 動画視聴機能

**対象**: 一般ユーザー | **要件ID**: REQ-3-2

**動画プレーヤー**:
- HTML5標準プレーヤー使用
- 再生/一時停止
- 音量調整
- 全画面表示
- シークバー操作

**動画情報表示**:
- タイトル
- 説明文
- アップロード日
- 視聴回数
- カテゴリ・タグ表示

**関連動画表示**:
- 同じカテゴリの動画
- 同じタグの動画
- 最大5件表示

**視聴履歴記録**:
- 視聴開始時に履歴記録
- 視聴時間の記録
- プロフィール画面から確認可能

### 4. ユーザー管理機能

#### 4.1. ユーザー管理機能

**対象**: 管理者 | **要件ID**: REQ-4-1

**ユーザー一覧表示**:
- ユーザー名
- メールアドレス
- 登録日
- 最終ログイン日
- 視聴動画数
- 操作ボタン（詳細/削除）

**ユーザー詳細**:
- 基本プロフィール情報
- 視聴履歴一覧
- 登録日・最終ログイン日

**ユーザー削除**:
- 削除確認ダイアログ表示
- ユーザーアカウントと関連データ削除
- 視聴履歴も同時削除

**ページネーション**:
- 1ページ50件表示
- 検索・フィルタリング機能

### 5. 管理者ダッシュボード機能

**対象**: 管理者 | **要件ID**: 暗黙的要件

**統計情報表示**:
- 総動画数
- 総ユーザー数
- 今日の視聴回数

**人気動画ランキング**:
- 視聴回数ベースのランキング
- 最大10件表示
- 動画詳細へのリンク

**クイックアクション**:
- 動画アップロードへのリンク
- 動画管理へのリンク
- ユーザー管理へのリンク

## 第2フェーズ（拡張機能）

### 収益化機能

#### 1. 有料動画管理機能

**対象**: 管理者

**価格設定**:
- 動画ごとの価格設定
- 価格プラン（買い切り、レンタル）
- 割引設定

**購入機能**:
- クレジットカード決済連携（Stripe または PayPal）
- 購入履歴管理
- 領収書発行

#### 2. サブスクリプション機能

**対象**: 一般ユーザー

**月額プラン**:
- プラン種類（ベーシック、プレミアム）
- プラン変更機能
- 自動更新処理

**請求管理**:
- 月次請求処理
- 請求履歴表示
- クレジットカード情報管理

### アクセス管理強化

#### 3. グループ管理機能

**対象**: 管理者

**グループ作成**:
- グループ名、説明設定
- ユーザーのグループ割り当て
- グループごとの動画公開制御

**アクセス制御**:
- グループ単位での動画公開範囲設定
- グループ外ユーザーからの非表示

#### 4. 招待制機能

**対象**: 管理者

**招待管理**:
- 招待リンク生成
- 招待メール送信
- 招待状況確認

**限定公開**:
- 招待されたユーザーのみアクセス可能
- 招待リンクの有効期限設定

#### 5. 視聴制限機能

**対象**: 管理者

**制限設定**:
- 視聴期限設定（開始日・終了日）
- 視聴回数制限設定
- 同時視聴数制限

**制限管理**:
- 制限状況の確認
- 制限の解除・変更

### セキュリティ強化

#### 6. メール認証機能

**対象**: 一般ユーザー

**認証フロー**:
- 登録時に認証メール送信
- メールリンクからの認証
- 認証完了後にログイン可能

**再送信機能**:
- 認証メールの再送信
- 認証リンクの有効期限（24時間）

#### 7. 二段階認証機能

**対象**: 管理者

**認証方式**:
- SMS認証
- 認証アプリ（Google Authenticator）
- バックアップコード

**設定管理**:
- 二段階認証の有効化/無効化
- 認証方式の選択
- バックアップコード生成

### 検索機能の拡充

#### 8. 全文検索機能

**対象**: 一般ユーザー

**検索対象**:
- 動画タイトル
- 動画説明文
- カテゴリ名
- タグ名

**検索エンジン**:
- Elasticsearchまたは Algolia導入
- 高速検索対応
- 検索候補の自動表示

## 除外機能

### 第1フェーズで実装しない機能
- リアルタイム配信機能
- 動画形式の自動変換機能（MP4形式のみ対応）
- 即座の通知配信機能
- 外部サービスとの連携機能
- 複数言語への対応（日本語のみ）

### 技術的制約による除外
- 動画ストリーミングの最適化（MVP段階では標準的な配信のみ）
- CDN連携（MVP段階では未実装）
- 動画の自動エンコーディング（アップロード時の形式チェックのみ）
