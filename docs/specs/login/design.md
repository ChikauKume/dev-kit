# 設計書: ログイン機能

## 概要

**何ができる？**
- ログイン
- ログアウト
- ダッシュボードへの遷移

**スコープ外**:
- パスワードリセット → `user-password-reset/design.md` 参照
- ユーザー登録 → `signup/design.md` 参照
- プロフィール管理(将来実装予定)

**関連要件ID**: REQ-1-2(ログイン・ログアウト)

---

## 画面フロー

### ログイン・ログアウトフロー
```
/login (LoginPage)
  │
  │ [入力内容]
  │ - メールアドレス
  │ - パスワード
  │
  ↓ 「ログイン」ボタン
  │
/dashboard (DashboardPage)
  │
  │ [表示内容]
  │ - 「ようこそ、{名前}さん」
  │
  │ [操作]
  │ - ユーザーメニュー → 「ログアウト」
  │
  ↓ 「ログアウト」ボタン
  │
/login(セッション無効化)
```

---

## 画面一覧

**画面一覧**: Login.tsx, Dashboard.tsx, Error404.tsx, Error500.tsx

| 画面 | URL | 何ができる？ | 使用テンプレート | 認証 |
|-----|-----|----------|--------------|-----|
| ログイン | `/login` | メール・パスワードでログイン | LoginPage | 不要 |
| ダッシュボード | `/dashboard` | ユーザー名表示のみ | DashboardPage | 必須 |
| 404エラー | - | ページが見つかりません | Error404Page | 不要 |
| 500エラー | - | サーバーエラー | Error500Page | 不要 |

---

## 入力項目とバリデーション

### ログインフォーム(/login)

| 項目 | 必須 | バリデーション | エラーメッセージ例 |
|-----|------|--------------|----------------|
| メール | ✅ | メール形式 | "有効なメールアドレスを入力してください。" |
| パスワード | ✅ | 必須 | "パスワードを入力してください。" |

**認証失敗時**: "メールアドレスまたはパスワードが正しくありません。"

---

## 特記事項

### ダッシュボード
- **認証必須**: middleware: auth
- **表示内容**: ログイン中のユーザー名を右上に動的表示
- **スコープ**: この機能に含む(ログイン後の最初のページ)
- **実装**: DashboardPageテンプレートにuserNameプロパティを渡す

**Controller実装例**:
```php
return Inertia::render('Dashboard', [
    'userName' => auth()->user()->name
]);
```

---

## テストケース

**詳細定義**:
- PHPUnit: `tests/phpunit.yaml`
- E2E: `tests/e2e.yaml`

### E2Eシナリオ概要(4件)

**正常系(2件)**:
- E2E-001: ログイン・ダッシュボード表示(右上ユーザー名確認)
- E2E-002: ログアウトとセッション無効化

**異常系(2件)**:
- E2E-003: ログイン失敗
- E2E-004: 認証済みユーザーのログイン画面アクセス(guestミドルウェア)

---

## 参照ドキュメント

**共通アーキテクチャ**:
- モジュール構造: `dev-kit/docs/architecture/modules.md`
- テスト戦略: `dev-kit/docs/architecture/testing.md`
- エラー処理: `dev-kit/docs/architecture/error-handling.md`
- データベース: `dev-kit/docs/architecture/db.md`
